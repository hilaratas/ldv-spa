(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d217357"],{c66d:function(e,t,s){"use strict";s.r(t);var a=s("7a23");const l={class:"form__table"},n=Object(a["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(a["createElementVNode"])("label",{class:"nowrap",for:"profile-name"},"Имя")],-1),o={class:"form__table-cell form__table-cell--wide form__table-cell--pb10px"},r=Object(a["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(a["createElementVNode"])("label",{class:"nowrap",for:"profile-surname"},"Фамилия")],-1),i={class:"form__table-cell form__table-cell--wide form__table-cell--pb10px"},c=Object(a["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(a["createElementVNode"])("label",{class:"nowrap",for:"profile-tel"},"Телефон")],-1),p={class:"form__table-cell form__table-cell--wide form__table-cell--pb10px"},d=Object(a["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(a["createElementVNode"])("label",{class:"nowrap",for:"profile-email"},"Email")],-1),m={class:"form__table-cell form__table-cell--wide form__table-cell--pb10px"},u={key:0,style:{"padding-top":"10px"}},h=Object(a["createElementVNode"])("small",{class:"control-description"}," Ваша почта не подтверждена. ",-1),f={key:1,style:{"padding-top":"10px"}},b=Object(a["createElementVNode"])("span",{class:"button button--small button--green"},"Ваша почта подтверждена",-1),k=[b],v=Object(a["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},null,-1),E={class:"form__table-cell form__table-cell--wide form__table-cell--pb10px"},g=["disabled"];function O(e,t,s,b,O,j){const _=Object(a["resolveDirective"])("maska");return Object(a["openBlock"])(),Object(a["createElementBlock"])("form",{action:"#",id:"profile",class:"form",onSubmit:t[5]||(t[5]=Object(a["withModifiers"])((...t)=>e.onSubmit&&e.onSubmit(...t),["prevent"]))},[Object(a["createElementVNode"])("table",l,[Object(a["createElementVNode"])("tbody",null,[Object(a["createElementVNode"])("tr",null,[n,Object(a["createElementVNode"])("td",o,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{class:"input",type:"text",name:"profile-name",id:"profile-name","onUpdate:modelValue":t[0]||(t[0]=t=>e.name=t)},null,512),[[a["vModelText"],e.name]])])]),Object(a["createElementVNode"])("tr",null,[r,Object(a["createElementVNode"])("td",i,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{class:"input",type:"text",name:"profile-surname",id:"profile-surname","onUpdate:modelValue":t[1]||(t[1]=t=>e.surname=t)},null,512),[[a["vModelText"],e.surname]])])]),Object(a["createElementVNode"])("tr",null,[c,Object(a["createElementVNode"])("td",p,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{class:"input",type:"tel",name:"profile-tel",id:"profile-tel","onUpdate:modelValue":t[2]||(t[2]=t=>e.tel=t),"data-maska":"+7(###)-###-##-##"},null,512),[[a["vModelText"],e.tel],[_]])])]),Object(a["createElementVNode"])("tr",null,[d,Object(a["createElementVNode"])("td",m,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{class:"input",type:"email",name:"profile-email",id:"profile-tel","onUpdate:modelValue":t[3]||(t[3]=t=>e.email=t),readonly:""},null,512),[[a["vModelText"],e.email]]),e.email_verified?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",f,k)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",u,[h,Object(a["createElementVNode"])("button",{class:"button button--small button--blue",onClick:t[4]||(t[4]=Object(a["withModifiers"])((...t)=>e.onVerifyEmail&&e.onVerifyEmail(...t),["prevent"]))},"Подтвердить")]))])]),v,Object(a["createElementVNode"])("td",E,[Object(a["createElementVNode"])("button",{type:"submit",disabled:e.isFormLoading,class:Object(a["normalizeClass"])(["button",{"is-loading":e.isFormLoading}])},"Отправить",10,g)])])])],32)}var j=s("5502"),_=Object.defineProperty,y=(e,t,s)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,w=(e,t,s)=>(y(e,"symbol"!=typeof t?t+"":t,s),s);
/*! maska v2.1.8 | (c) Alexander Shabunevich | Released under the MIT license */const V={"#":{pattern:/[0-9]/},"@":{pattern:/[a-zA-Z]/},"*":{pattern:/[a-zA-Z0-9]/}};class M{constructor(e={}){var t;w(this,"opts",{}),w(this,"memo",new Map);const s={...e};if(null!=s.tokens){s.tokens=s.tokensReplace?{...s.tokens}:{...V,...s.tokens};for(const e of Object.values(s.tokens))"string"==typeof e.pattern&&(e.pattern=new RegExp(e.pattern))}else s.tokens=V;Array.isArray(s.mask)&&(s.mask.length>1?s.mask=[...s.mask].sort((e,t)=>e.length-t.length):s.mask=null!=(t=s.mask[0])?t:""),""===s.mask&&(s.mask=null),this.opts=s}masked(e){return this.process(e,this.findMask(e))}unmasked(e){return this.process(e,this.findMask(e),!1)}isEager(){return!0===this.opts.eager}isReversed(){return!0===this.opts.reversed}completed(e){const t=this.findMask(e);if(null==this.opts.mask||null==t)return!1;const s=this.process(e,t).length;return"string"==typeof this.opts.mask?s>=this.opts.mask.length:"function"==typeof this.opts.mask?s>=t.length:this.opts.mask.filter(e=>s>=e.length).length===this.opts.mask.length}findMask(e){var t,s;const a=this.opts.mask;if(null==a)return null;if("string"==typeof a)return a;if("function"==typeof a)return a(e);const l=this.process(e,null!=(t=a.slice(-1).pop())?t:"",!1);return null!=(s=a.find(t=>this.process(e,t,!1).length>=l.length))?s:""}escapeMask(e){const t=[],s=[];return e.split("").forEach((a,l)=>{"!"===a&&"!"!==e[l-1]?s.push(l-s.length):t.push(a)}),{mask:t.join(""),escaped:s}}process(e,t,s=!0){var a;if(null==t)return e;const l=`value=${e},mask=${t},masked=${s?1:0}`;if(this.memo.has(l))return this.memo.get(l);const{mask:n,escaped:o}=this.escapeMask(t),r=[],i=null!=this.opts.tokens?this.opts.tokens:{},c=this.isReversed()?-1:1,p=this.isReversed()?"unshift":"push",d=this.isReversed()?0:n.length-1,m=this.isReversed()?()=>b>-1&&k>-1:()=>b<n.length&&k<e.length,u=e=>!this.isReversed()&&e<=d||this.isReversed()&&e>=d;let h,f=-1,b=this.isReversed()?n.length-1:0,k=this.isReversed()?e.length-1:0;for(;m();){const t=n.charAt(b),l=i[t],m=null!=(null==l?void 0:l.transform)?l.transform(e.charAt(k)):e.charAt(k);if(o.includes(b)||null==l)s&&!this.isEager()&&r[p](t),m!==t||this.isEager()?h=t:k+=c,this.isEager()||(b+=c);else{if(null!=m.match(l.pattern))r[p](m),l.repeated?(-1===f?f=b:b===d&&b!==f&&(b=f-c),d===f&&(b-=c)):l.multiple&&(b-=c),b+=c;else if(l.multiple){const e=null!=(null==(a=r[k-c])?void 0:a.match(l.pattern)),t=n.charAt(b+c);e&&""!==t&&null==i[t]?(b+=c,k-=c):r[p]("")}else m===h?h=void 0:l.optional&&(b+=c,k-=c);k+=c}if(this.isEager())for(;u(b)&&(null==i[n.charAt(b)]||o.includes(b));)s?r[p](n.charAt(b)):n.charAt(b)===e.charAt(k)&&(k+=c),b+=c}return this.memo.set(l,r.join("")),this.memo.get(l)}}const N=e=>JSON.parse(e.replaceAll("'",'"')),x=(e,t={})=>{const s={...t};return null!=e.dataset.maska&&""!==e.dataset.maska&&(s.mask=R(e.dataset.maska)),null!=e.dataset.maskaEager&&(s.eager=A(e.dataset.maskaEager)),null!=e.dataset.maskaReversed&&(s.reversed=A(e.dataset.maskaReversed)),null!=e.dataset.maskaTokensReplace&&(s.tokensReplace=A(e.dataset.maskaTokensReplace)),null!=e.dataset.maskaTokens&&(s.tokens=T(e.dataset.maskaTokens)),s},A=e=>""===e||Boolean(JSON.parse(e)),R=e=>e.startsWith("[")&&e.endsWith("]")?N(e):e,T=e=>{if(e.startsWith("{")&&e.endsWith("}"))return N(e);const t={};return e.split("|").forEach(e=>{const s=e.split(":");t[s[0]]={pattern:new RegExp(s[1]),optional:"optional"===s[2],multiple:"multiple"===s[2],repeated:"repeated"===s[2]}}),t};class S{constructor(e,t={}){w(this,"items",new Map),w(this,"beforeinputEvent",e=>{const t=e.target,s=this.items.get(t);s.isEager()&&"inputType"in e&&e.inputType.startsWith("delete")&&s.unmasked(t.value).length<=1&&this.setMaskedValue(t,"")}),w(this,"inputEvent",e=>{if(e instanceof CustomEvent&&"input"===e.type&&null!=e.detail&&"object"==typeof e.detail&&"masked"in e.detail)return;const t=e.target,s=this.items.get(t),a=t.value,l=t.selectionStart,n=t.selectionEnd;let o=a;if(s.isEager()){const t=s.masked(a),l=s.unmasked(a);""===l&&"data"in e&&null!=e.data?o=e.data:l!==s.unmasked(t)&&(o=l)}if(this.setMaskedValue(t,o),"inputType"in e&&(e.inputType.startsWith("delete")||null!=l&&l<a.length))try{t.setSelectionRange(l,n)}catch{}}),this.options=t,"string"==typeof e?this.init(Array.from(document.querySelectorAll(e)),this.getMaskOpts(t)):this.init("length"in e?Array.from(e):[e],this.getMaskOpts(t))}destroy(){for(const e of this.items.keys())e.removeEventListener("input",this.inputEvent),e.removeEventListener("beforeinput",this.beforeinputEvent);this.items.clear()}needUpdateOptions(e,t){const s=this.items.get(e),a=new M(x(e,this.getMaskOpts(t)));return JSON.stringify(s.opts)!==JSON.stringify(a.opts)}needUpdateValue(e){const t=e.dataset.maskaValue;return null==t&&""!==e.value||null!=t&&t!==e.value}getMaskOpts(e){const{onMaska:t,preProcess:s,postProcess:a,...l}=e;return l}init(e,t){for(const s of e){const e=new M(x(s,t));this.items.set(s,e),""!==s.value&&this.setMaskedValue(s,s.value),s.addEventListener("input",this.inputEvent),s.addEventListener("beforeinput",this.beforeinputEvent)}}setMaskedValue(e,t){const s=this.items.get(e);null!=this.options.preProcess&&(t=this.options.preProcess(t));const a=s.masked(t),l=s.unmasked(s.isEager()?a:t),n=s.completed(t),o={masked:a,unmasked:l,completed:n};t=a,null!=this.options.postProcess&&(t=this.options.postProcess(t)),e.value=t,e.dataset.maskaValue=t,null!=this.options.onMaska&&(Array.isArray(this.options.onMaska)?this.options.onMaska.forEach(e=>e(o)):this.options.onMaska(o)),e.dispatchEvent(new CustomEvent("maska",{detail:o})),e.dispatchEvent(new CustomEvent("input",{detail:o}))}}const C=new WeakMap,D=e=>{setTimeout(()=>{var t;!0===(null==(t=C.get(e))?void 0:t.needUpdateValue(e))&&e.dispatchEvent(new CustomEvent("input"))})},P=(e,t)=>{const s=e instanceof HTMLInputElement?e:e.querySelector("input"),a={...t.arg};if(null==s)return;D(s);const l=C.get(s);if(null!=l){if(!l.needUpdateOptions(s,a))return;l.destroy()}if(null!=t.value){const e=t.value,s=t=>{e.masked=t.masked,e.unmasked=t.unmasked,e.completed=t.completed};a.onMaska=null==a.onMaska?s:Array.isArray(a.onMaska)?[...a.onMaska,s]:[a.onMaska,s]}C.set(s,new S(s,a))};var L=Object(a["defineComponent"])({name:"Profile",setup(){const e=Object(j["e"])(),t=Object(a["computed"])(()=>e.getters["auth/userId"]),s=e.getters["auth/user"],l=e.getters["profile/profile"],n=(Object(a["ref"])(t),Object(a["ref"])(l.name)),o=Object(a["ref"])(l.surname),r=Object(a["ref"])(l.tel),i=Object(a["ref"])(!1),c=Object(a["ref"])(s.email),p=Object(a["ref"])(s.email_verified);async function d(){const s={userId:t.value,name:n.value,surname:o.value,tel:r.value};i.value=!0;const a=await e.dispatch("profile/editProfile",s);a.result?await e.dispatch("alerts/alertAdd",{id:Date.now(),text:"Ваш профиль отредактирован",type:"success",closable:!0,autoClosable:!0}):await e.dispatch("alerts/alertAdd",{id:Date.now(),text:"Во время редактирования профиля произошла ошибка. <br> Пожалуйста, повторите попытку позже.",type:"error",closable:!0,autoClosable:!0}),i.value=!1}async function m(){const t=await e.dispatch("auth/verifyEmail");t.result?await e.dispatch("alerts/alertAdd",{id:Date.now(),text:"На вашу почту отправлено письмо с кодом подтверждения",type:"success",closable:!0,autoClosable:!1}):await e.dispatch("alerts/alertAdd",{id:Date.now(),text:"Во время отправки письма с кодом подтверждения произошла ошибка. <br> Повторите попытку позже",type:"error",closable:!0,autoClosable:!1})}return{name:n,surname:o,tel:r,email:c,email_verified:p,isFormLoading:i,onSubmit:d,onVerifyEmail:m}},directives:{maska:P}}),U=s("6b0d"),B=s.n(U);const W=B()(L,[["render",O]]);t["default"]=W}}]);
//# sourceMappingURL=chunk-2d217357.eed47aba.js.map