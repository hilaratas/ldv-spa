{"version":3,"sources":["webpack:///./src/views/catalog/CatalogSectionEdit.vue","webpack:///./src/views/catalog/CatalogSectionEdit.vue?1785","webpack:///./src/components/App404.vue","webpack:///./src/components/App404.vue?0159","webpack:///./src/filter/hru.filter.ts"],"names":["_createElementVNode","class","style","_ctx","isSectionExist","_createElementBlock","action","id","formName","onSubmit","_cache","_withModifiers","args","_hoisted_6","_createVNode","_component_news_input_row","inputName","label","description","controlValue","section","img","$event","errors","v$","$errors","title","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_toDisplayString","hru","_hoisted_14","isHruValid","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","type","disabled","isFormLoading","_normalizeClass","_hoisted_21","needShowButtons","_hoisted_22","_component_router_link","to","_hoisted_23","_createBlock","_component_app_404","key","_hoisted_1","_hoisted_2","isAdmin","_hoisted_3","_hoisted_4","defineComponent","name","setup","store","useStore","route","useRoute","useRouter","routeHru","params","computed","getters","ref","isAlreadyCreated","sectionRules","required","sectionDefault","reactive","useVuelidate","hruFilter","value","watch","async","newHru","dispatch","onMounted","data","Object","keys","map","_data$key","$touch","$error","res","oldHru","$reset","Date","now","text","closable","autoClosable","components","NewsInputRow","App404","__exports__","render","_renderSlot","$slots","str","ru","n_str","trim","replace","i","length","push","undefined","toLowerCase","toUpperCase","join"],"mappings":"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","file":"js/chunk-198aeef4.dd6c3484.js","sourcesContent":["<template>\r\n  <app-404 v-if=\"!isSectionExist\">\r\n    <div class=\"title title--h1\">404</div>\r\n    <div>Такаго раздела каталога не существует</div>\r\n    <div v-if=\"isAdmin\">\r\n      <br>\r\n      <router-link to=\"/catalog/add\" class=\"button\">Добавить раздел каталога</router-link>\r\n    </div>\r\n  </app-404>\r\n  <form v-else action=\"#\" :id=\"formName\" class=\"form\" @submit.prevent=\"onSubmit\">\r\n    <table class=\"form__table\">\r\n      <tbody>\r\n      <news-input-row\r\n          :formName=\"formName\"\r\n          inputName=\"catalog-img\"\r\n          label=\"Ссылку на картинку *\"\r\n          description=\"Поле обязательно к заполнению.\r\n          Картинка в формате jpg, png, svg, webp. Размер картинки не более 800*800px.\r\n          <br> Вес картинки не более 2Мб\"\r\n          v-model:controlValue=\"section.img\"\r\n          :errors=\"v$.img.$errors\"\r\n      >\r\n      </news-input-row>\r\n      <news-input-row\r\n          :formName=\"formName\"\r\n          inputName=\"catalog-title\"\r\n          label=\"Заголовок раздела *\"\r\n          description=\"Поле обязательно к заполнению\"\r\n          v-model:controlValue=\"section.title\"\r\n          :errors=\"v$.title.$errors\"\r\n      >\r\n      </news-input-row>\r\n      <tr>\r\n        <td class=\"form__table-cell\">\r\n          ЧПУ\r\n        </td>\r\n        <td class=\"form__table-cell form__table-cell--wide\">\r\n          <div style=\"padding-bottom: 20px\">\r\n            <div class=\"input input--only-bottom\">\r\n              <div class=\"row\">\r\n                <div class=\"col\">\r\n                  <small class=\"\">{{hru}}</small>\r\n                </div>\r\n                <div class=\"col-auto\">\r\n                  <span v-if=\"isHruValid\" class=\"check is-seccess\">✔</span>\r\n                  <span v-else class=\"check is-error\">✘</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td class=\"form__table-cell\"></td>\r\n        <td class=\"form__table-cell form__table-cell--wide\">\r\n          <div class=\"row\">\r\n            <div class=\"col-auto\">\r\n              <button type=\"submit\" :disabled=\"isFormLoading\" :class=\"['button', {'is-loading': isFormLoading}]\" >Отправить</button>\r\n            </div>\r\n            <div v-if=\"needShowButtons\" class=\"col-auto\">\r\n              <router-link to=\"/catalog/\" class=\"button\">Посмотреть каталог</router-link>\r\n            </div>\r\n            <div v-if=\"needShowButtons\" class=\"col-auto\">\r\n              <router-link :to=\"'/catalog/edit/' + hru\" class=\"button\">Редактировать раздел каталога</router-link>\r\n            </div>\r\n          </div>\r\n        </td>\r\n      </tr>\r\n      </tbody>\r\n    </table>\r\n  </form>\r\n</template>\r\n\r\n<script>\r\nimport {ref, computed, reactive, watch, onMounted, defineComponent} from \"vue\"\r\nimport { useStore } from \"vuex\"\r\nimport  { useRoute } from \"vue-router\"\r\nimport { useVuelidate } from '@vuelidate/core'\r\nimport { useRouter} from \"vue-router\";\r\nimport { required } from '@vuelidate/validators'\r\nimport { hruFilter } from \"@/filter/hru.filter\"\r\nimport App404 from \"@/components/App404\"\r\nimport NewsInputRow from \"@/components/News/NewsInputRow\"\r\n\r\nexport default defineComponent({\r\n  name: \"CatalogSectionAdd\",\r\n  setup() {\r\n    const store = useStore()\r\n    const route = useRoute()\r\n    const router = useRouter()\r\n    const formName = \"catalog-types\"\r\n    const routeHru = route.params.hru\r\n    const isAdmin = computed(() => store.getters[\"auth/isAdmin\"])\r\n    const isHruValid = ref(true)\r\n    const isFormLoading = ref(false)\r\n    const isSectionExist = ref(false)\r\n    const isAlreadyCreated = ref(false)\r\n    const sectionRules = { img: {required}, title: {required} }\r\n    const sectionDefault = { hru: '', img: '', title: '' }\r\n    const section = reactive({...sectionDefault})\r\n    const v$ = useVuelidate(sectionRules, section)\r\n    const hru = computed(() => hruFilter(section.title))\r\n\r\n    const needShowButtons = computed(() => (\r\n        !isAlreadyCreated.value ?  false :  !(section.img || section.title )\r\n      ))\r\n\r\n    watch( hru, async (newHru) => {\r\n      if (routeHru === newHru) {\r\n        isHruValid.value = true\r\n        return\r\n      }\r\n      isHruValid.value = await store.dispatch('catalog/isUniqueCatalogSection', newHru)\r\n    })\r\n\r\n    onMounted(async () => {\r\n      const data = store.getters['catalog/catalogSection'](routeHru)\r\n      if ( !data) {\r\n        isSectionExist.value = false\r\n      } else {\r\n        isSectionExist.value = true\r\n        Object.keys(section).map(key => section[key] = data[key] ?? section[key])\r\n      }\r\n    })\r\n\r\n    const onSubmit = async () => {\r\n      v$.value.$touch()\r\n      if (v$.value.$error) {\r\n        return;\r\n      }\r\n\r\n      isFormLoading.value = true\r\n      const res = await store.dispatch('catalog/editCatalogSection', {...section, oldHru: routeHru, newHru: hru.value })\r\n      if (res) {\r\n        isAlreadyCreated.value = true\r\n        v$.value.$reset()\r\n        await store.dispatch('alerts/alertAdd', {\r\n          id: Date.now(),\r\n          text: `Раздел каталога успешно отредактирован`,\r\n          type: 'success',\r\n          closable: true,\r\n          autoClosable: false\r\n        })\r\n        await store.dispatch('catalog/fetchCatalogSections')\r\n\r\n      } else {\r\n        await store.dispatch('alerts/alertAdd', {\r\n          id: Date.now(),\r\n          text: 'Ошибка сервера при редактировании раздела каталога',\r\n          type: 'error',\r\n          closable: true,\r\n          autoClosable: false\r\n        })\r\n      }\r\n      isFormLoading.value = false\r\n    }\r\n    return {\r\n      formName,\r\n      section,\r\n      hru,\r\n      v$,\r\n      isAdmin,\r\n      isHruValid,\r\n      isFormLoading,\r\n      isSectionExist,\r\n      isAlreadyCreated,\r\n      needShowButtons,\r\n      onSubmit\r\n    }\r\n  },\r\n  components: { NewsInputRow, App404 }\r\n})\r\n</script>","import { render } from \"./CatalogSectionEdit.vue?vue&type=template&id=6f36100e\"\nimport script from \"./CatalogSectionEdit.vue?vue&type=script&lang=js\"\nexport * from \"./CatalogSectionEdit.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Programming\\\\LDV spa\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n  <slot>\r\n    <div class=\"title title--h1\">404</div>\r\n    <div>Запрашиваемый вами ресурс не найден. <br>\r\n      Воспользуйтесь главным меню для навигации по сайту\r\n    </div>\r\n  </slot>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"404\"\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import { render } from \"./App404.vue?vue&type=template&id=7224262c\"\nimport script from \"./App404.vue?vue&type=script&lang=js\"\nexport * from \"./App404.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Programming\\\\LDV spa\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","interface TranslitSymbol {\r\n  [key: string] : string\r\n}\r\n\r\nexport function hruFilter (str :string ) :string {\r\n  var ru : TranslitSymbol = {\r\n    'а': 'a', 'б': 'b', 'в': 'v', 'г': 'g', 'д': 'd',\r\n    'е': 'e', 'ё': 'e', 'ж': 'j', 'з': 'z', 'и': 'i',\r\n    'к': 'k', 'л': 'l', 'м': 'm', 'н': 'n', 'о': 'o',\r\n    'п': 'p', 'р': 'r', 'с': 's', 'т': 't', 'у': 'u',\r\n    'ф': 'f', 'х': 'h', 'ц': 'c', 'ч': 'ch', 'ш': 'sh',\r\n    'щ': 'shch', 'ы': 'y', 'э': 'e', 'ю': 'u', 'я': 'ya',\r\n    ' ': '-'\r\n  }, n_str = [];\r\n\r\n  str = str.trim().replace(/[ъь]+/g, '').replace(/й/g, 'i');\r\n\r\n  for (var i = 0; i < str.length; ++i) {\r\n    n_str.push(\r\n      ru[str[i]]\r\n      || ru[str[i].toLowerCase()] == undefined && str[i]\r\n      || ru[str[i].toLowerCase()].toUpperCase()\r\n    );\r\n  }\r\n\r\n  return n_str.join('');\r\n}\r\n\r\n"],"sourceRoot":""}