(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c5cd68c"],{"8aa3":function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));o("14d9");function c(e){var t={"а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"e","ж":"j","з":"z","и":"i","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"shch","ы":"y","э":"e","ю":"u","я":"ya"," ":"-"},o=[];e=e.trim().replace(/[ъь]+/g,"").replace(/й/g,"i");for(var c=0;c<e.length;++c)o.push(t[e[c]]||void 0==t[e[c].toLowerCase()]&&e[c]||t[e[c].toLowerCase()].toUpperCase());return o.join("")}},c4a9:function(e,t,o){"use strict";(function(e){o.d(t,"a",(function(){return r}));var c=function(){return"undefined"!==typeof window?window:e},r=function(){var e=c();return e&&e.tinymce?e.tinymce:null}}).call(this,o("c8ba"))},ca72:function(e,t,o){"use strict";var c=o("7a23"),r=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],n=function(e){return-1!==r.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},l=function(e,t,o){Object.keys(t).filter(n).forEach((function(c){var r=t[c];"function"===typeof r&&("onInit"===c?r(e,o):o.on(c.substring(2),(function(e){return r(e,o)})))}))},a=function(e,t,o,r){var n=e.modelEvents?e.modelEvents:null,l=Array.isArray(n)?n.join(" "):n;Object(c["watch"])(r,(function(t,c){o&&"string"===typeof t&&t!==c&&t!==o.getContent({format:e.outputFormat})&&o.setContent(t)})),o.on(l||"change input undo redo",(function(){t.emit("update:modelValue",o.getContent({format:e.outputFormat}))}))},i=function(e,t,o,c,r,n){c.setContent(n()),o.attrs["onUpdate:modelValue"]&&a(t,o,c,r),l(e,o.attrs,c)},d=0,s=function(e){var t=Date.now(),o=Math.floor(1e9*Math.random());return d++,e+"_"+o+d+String(t)},u=function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()},b=function(e){return"undefined"===typeof e||""===e?[]:Array.isArray(e)?e:e.split(" ")},m=function(e,t){return b(e).concat(b(t))},p=function(e){return null===e||void 0===e},O=function(){return{listeners:[],scriptId:s("tiny-script"),scriptLoaded:!1}},j=function(){var e=O(),t=function(e,t,o,c){var r=t.createElement("script");r.referrerPolicy="origin",r.type="application/javascript",r.id=e,r.src=o;var n=function(){r.removeEventListener("load",n),c()};r.addEventListener("load",n),t.head&&t.head.appendChild(r)},o=function(o,c,r){e.scriptLoaded?r():(e.listeners.push(r),o.getElementById(e.scriptId)||t(e.scriptId,o,c,(function(){e.listeners.forEach((function(e){return e()})),e.scriptLoaded=!0})))},c=function(){e=O()};return{load:o,reinitialize:c}},f=j(),v=o("c4a9"),V={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},N=function(){return N=Object.assign||function(e){for(var t,o=1,c=arguments.length;o<c;o++)for(var r in t=arguments[o],t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},N.apply(this,arguments)},g=function(e,t,o,c){return e(c||"div",{id:t,ref:o})},E=function(e,t,o){return e("textarea",{id:t,visibility:"hidden",ref:o})},y=Object(c["defineComponent"])({props:V,setup:function(e,t){var o=e.init?N({},e.init):{},r=Object(c["toRefs"])(e),n=r.disabled,l=r.modelValue,a=r.tagName,d=Object(c["ref"])(null),b=null,O=e.id||s("tiny-vue"),j=e.init&&e.init.inline||e.inline,V=!!t.attrs["onUpdate:modelValue"],y=!0,h=e.initialValue?e.initialValue:"",k="",w=function(e){return V?function(){return(null===l||void 0===l?void 0:l.value)?l.value:""}:function(){return e?h:k}},_=function(){var c=w(y),r=N(N({},o),{readonly:e.disabled,selector:"#"+O,plugins:m(o.plugins,e.plugins),toolbar:e.toolbar||o.toolbar,inline:j,setup:function(r){b=r,r.on("init",(function(o){return i(o,e,t,r,l,c)})),"function"===typeof o.setup&&o.setup(r)}});u(d.value)&&(d.value.style.visibility=""),Object(v["a"])().init(r),y=!1};Object(c["watch"])(n,(function(e){var t;null!==b&&("function"===typeof(null===(t=b.mode)||void 0===t?void 0:t.set)?b.mode.set(e?"readonly":"design"):b.setMode(e?"readonly":"design"))})),Object(c["watch"])(a,(function(e){var t;V||(k=b.getContent()),null===(t=Object(v["a"])())||void 0===t||t.remove(b),Object(c["nextTick"])((function(){return _()}))})),Object(c["onMounted"])((function(){if(null!==Object(v["a"])())_();else if(d.value&&d.value.ownerDocument){var t=e.cloudChannel?e.cloudChannel:"5",o=e.apiKey?e.apiKey:"no-api-key",c=p(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+o+"/tinymce/"+t+"/tinymce.min.js":e.tinymceScriptSrc;f.load(d.value.ownerDocument,c,_)}})),Object(c["onBeforeUnmount"])((function(){null!==Object(v["a"])()&&Object(v["a"])().remove(b)})),j||(Object(c["onActivated"])((function(){y||_()})),Object(c["onDeactivated"])((function(){var e;V||(k=b.getContent()),null===(e=Object(v["a"])())||void 0===e||e.remove(b)})));var S=function(e){var t;k=b.getContent(),null===(t=Object(v["a"])())||void 0===t||t.remove(b),o=N(N({},o),e),Object(c["nextTick"])((function(){return _()}))};return t.expose({rerender:S}),function(){return j?g(c["h"],O,d,e.tagName):E(c["h"],O,d)}}});t["a"]=y},fe50:function(e,t,o){"use strict";o.r(t);var c=o("7a23");const r=["id"],n={class:"form__table"},l=Object(c["createElementVNode"])("td",{class:"form__table-cell"}," ЧПУ ",-1),a={class:"form__table-cell form__table-cell--wide"},i={style:{"padding-bottom":"20px"}},d={class:"input input--only-bottom"},s={class:"row"},u={class:"col"},b={class:"col-auto"},m={key:0,class:"check is-seccess"},p={key:1,class:"check is-error"},O=Object(c["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(c["createElementVNode"])("label",{class:"nowrap"},"Цвета *")],-1),j={class:"form__table-cell form__table-cell--wide"},f={class:"row row--6px"},v={class:"col-auto"},V={class:"product-color"},N=Object(c["createElementVNode"])("span",{class:"radio_attr_label"},"Черный",-1),g={class:"col-auto"},E={class:"product-color"},y=Object(c["createElementVNode"])("span",{class:"radio_attr_label"},"Серебрянный",-1),h={class:"col-auto"},k={class:"product-color"},w=Object(c["createElementVNode"])("span",{class:"radio_attr_label"},"Медный",-1),_={class:"control-error-holder"},S={key:0,class:"control-error"},C=Object(c["createElementVNode"])("div",{style:{"padding-bottom":"10px"}},[Object(c["createElementVNode"])("small",{class:"control-description",id:"product-color-disc"},"Поле обязательно к заполнению")],-1),B=Object(c["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(c["createElementVNode"])("label",{class:"nowrap",for:"product-forOrder"},"Под заказ")],-1),x={class:"form__table-cell form__table-cell--wide"},D={class:"form__row"},$={class:"checkbox"},U=Object(c["createElementVNode"])("span",{class:"checkbox__indicator"},null,-1),L=Object(c["createElementVNode"])("div",{style:{"padding-bottom":"10px"}},[Object(c["createElementVNode"])("small",{class:"control-description",id:"product-forOrder-disc"},"Поле необязательно к заполнению")],-1),M=Object(c["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(c["createElementVNode"])("label",{class:"nowrap"},"Раздел каталога *")],-1),P={class:"form__table-cell form__table-cell--wide"},A={class:"select"},F=Object(c["createElementVNode"])("option",{value:"",disabled:""},"Выберите раздел",-1),q=["value"],I={class:"control-error-holder"},R={key:0,class:"control-error"},K=Object(c["createElementVNode"])("div",{style:{"padding-bottom":"10px"}},[Object(c["createElementVNode"])("small",{class:"control-description",id:"product-section-disc"},"Поле обязательно к заполнению")],-1),T=Object(c["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(c["createElementVNode"])("label",{class:"nowrap"},"Описание издения *")],-1),H={class:"form__table-cell form__table-cell--wide"},z={class:"control-error-holder"},J={key:0,class:"control-error"},G=Object(c["createElementVNode"])("div",{style:{"padding-bottom":"10px"}},[Object(c["createElementVNode"])("small",{class:"control-description",id:"product-desc-disc"},"Поле обязательно к заполнению")],-1),Y=Object(c["createElementVNode"])("td",{class:"form__table-cell"},null,-1),Q={class:"form__table-cell form__table-cell--wide"},W={class:"row"},X={class:"col-auto"},Z=["disabled"],ee={key:0,class:"col-auto"},te={key:1,class:"col-auto"};function oe(e,t,o,oe,ce,re){const ne=Object(c["resolveComponent"])("news-input-row"),le=Object(c["resolveComponent"])("editor"),ae=Object(c["resolveComponent"])("router-link");return Object(c["openBlock"])(),Object(c["createElementBlock"])("form",{action:"#",id:oe.formName,class:"form",onSubmit:t[11]||(t[11]=Object(c["withModifiers"])((...e)=>oe.onSubmit&&oe.onSubmit(...e),["prevent"]))},[Object(c["createElementVNode"])("table",n,[Object(c["createElementVNode"])("tbody",null,[Object(c["createVNode"])(ne,{formName:oe.formName,inputName:"product-title",label:"Название изделия*",description:"Поле обязательно к заполнению",controlValue:oe.product.title,"onUpdate:controlValue":t[0]||(t[0]=e=>oe.product.title=e),errors:oe.v$.title.$errors},null,8,["formName","controlValue","errors"]),Object(c["createElementVNode"])("tr",null,[l,Object(c["createElementVNode"])("td",a,[Object(c["createElementVNode"])("div",i,[Object(c["createElementVNode"])("div",d,[Object(c["createElementVNode"])("div",s,[Object(c["createElementVNode"])("div",u,[Object(c["createElementVNode"])("small",null,Object(c["toDisplayString"])(oe.hru),1)]),Object(c["createElementVNode"])("div",b,[oe.isHruValid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",m,"✔")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",p,"✘"))])])])])])]),Object(c["createVNode"])(ne,{formName:oe.formName,inputName:"product-img",label:"Ссылка на картинку",description:"Поле обязательно к заполнению.\r\n          Картинка в формате jpg, png, svg, webp. Размер картинки не более 800*800px.\r\n          <br> Вес картинки не более 2Мб",controlValue:oe.product.img,"onUpdate:controlValue":t[1]||(t[1]=e=>oe.product.img=e),errors:oe.v$.img.$errors},null,8,["formName","controlValue","errors"]),Object(c["createVNode"])(ne,{formName:oe.formName,inputName:"product-olp-price",inputType:"number",label:"Старая цена",description:"Поле необязательно к заполнению",controlValue:oe.product.oldPrice,"onUpdate:controlValue":t[2]||(t[2]=e=>oe.product.oldPrice=e),errors:[]},null,8,["formName","controlValue"]),Object(c["createVNode"])(ne,{formName:oe.formName,inputName:"product-price",inputType:"number",label:"Новая цена *",description:"Поле обязательно к заполнению",controlValue:oe.product.price,"onUpdate:controlValue":t[3]||(t[3]=e=>oe.product.price=e),errors:oe.v$.price.$errors},null,8,["formName","controlValue","errors"]),Object(c["createVNode"])(ne,{formName:oe.formName,inputName:"product-pubDate",inputType:"date",label:"Дата публикации",description:"2 месяца со дня публикации изделия считается новым. <br>\r\n          Если дата публикации больше текущей даты, продукт не отображается на сайте",controlValue:oe.product.pubDate,"onUpdate:controlValue":t[4]||(t[4]=e=>oe.product.pubDate=e),errors:[]},null,8,["formName","controlValue"]),Object(c["createElementVNode"])("tr",null,[O,Object(c["createElementVNode"])("td",j,[Object(c["createElementVNode"])("div",f,[Object(c["createElementVNode"])("div",v,[Object(c["createElementVNode"])("label",V,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"checkbox",name:"product-color",value:"black",checked:"","onUpdate:modelValue":t[5]||(t[5]=e=>oe.product.colors=e)},null,512),[[c["vModelCheckbox"],oe.product.colors]]),N])]),Object(c["createElementVNode"])("div",g,[Object(c["createElementVNode"])("label",E,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"checkbox",name:"product-color",value:"silver","onUpdate:modelValue":t[6]||(t[6]=e=>oe.product.colors=e)},null,512),[[c["vModelCheckbox"],oe.product.colors]]),y])]),Object(c["createElementVNode"])("div",h,[Object(c["createElementVNode"])("label",k,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"checkbox",name:"product-color",value:"copper","onUpdate:modelValue":t[7]||(t[7]=e=>oe.product.colors=e)},null,512),[[c["vModelCheckbox"],oe.product.colors]]),w])])]),Object(c["createElementVNode"])("div",_,[oe.v$.colors.$errors.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",S,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(oe.v$.colors.$errors,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createElementVNode"])("div",null,Object(c["toDisplayString"])(e.$message),1)]))),256))])):Object(c["createCommentVNode"])("",!0)]),C])]),Object(c["createElementVNode"])("tr",null,[B,Object(c["createElementVNode"])("td",x,[Object(c["createElementVNode"])("div",D,[Object(c["createElementVNode"])("label",$,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"checkbox",id:"product-forOrder",name:"product-forOrder",value:"1","onUpdate:modelValue":t[8]||(t[8]=e=>oe.product.forOrder=e)},null,512),[[c["vModelCheckbox"],oe.product.forOrder]]),U])]),L])]),Object(c["createElementVNode"])("tr",null,[M,Object(c["createElementVNode"])("td",P,[Object(c["createElementVNode"])("div",A,[Object(c["withDirectives"])(Object(c["createElementVNode"])("select",{name:"product-section",id:"product-section",class:"select__select","aria-describedby":"product-section-disc","onUpdate:modelValue":t[9]||(t[9]=e=>oe.product.catalogSection=e)},[F,(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(oe.catalogSections,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("option",{value:t},Object(c["toDisplayString"])(e.title),9,q))),256))],512),[[c["vModelSelect"],oe.product.catalogSection]])]),Object(c["createElementVNode"])("div",I,[oe.v$.catalogSection.$errors.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",R,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(oe.v$.catalogSection.$errors,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createElementVNode"])("div",null,Object(c["toDisplayString"])(e.$message),1)]))),256))])):Object(c["createCommentVNode"])("",!0)]),K])]),Object(c["createElementVNode"])("tr",null,[T,Object(c["createElementVNode"])("td",H,[Object(c["createVNode"])(le,{modelValue:oe.product.desc,"onUpdate:modelValue":t[10]||(t[10]=e=>oe.product.desc=e),"api-key":oe.tinymceKey,"aria-describedby":"product-desc-disc"},null,8,["modelValue","api-key"]),Object(c["createElementVNode"])("div",z,[oe.v$.desc.$errors.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",J,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(oe.v$.desc.$errors,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createElementVNode"])("div",null,Object(c["toDisplayString"])(e.$message),1)]))),256))])):Object(c["createCommentVNode"])("",!0)]),G])]),Object(c["createElementVNode"])("tr",null,[Y,Object(c["createElementVNode"])("td",Q,[Object(c["createElementVNode"])("div",W,[Object(c["createElementVNode"])("div",X,[Object(c["createElementVNode"])("button",{type:"submit",disabled:oe.isFormLoading,class:Object(c["normalizeClass"])(["button",{"is-loading":oe.isFormLoading}])},"Отправить",10,Z)]),oe.needShowButtons?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",ee,[Object(c["createVNode"])(ae,{to:"/catalog/"+oe.reserveSection+"/"+oe.reserveHru,class:"button"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("Посмотреть продукт")]),_:1},8,["to"])])):Object(c["createCommentVNode"])("",!0),oe.needShowButtons?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",te,[Object(c["createVNode"])(ae,{to:"/catalog/product/edit/"+oe.reserveHru,class:"button"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("Редактировать продукт")]),_:1},8,["to"])])):Object(c["createCommentVNode"])("",!0)])])])])])],40,r)}var ce=o("5502"),re=o("6605"),ne=o("c3b3"),le=o("b9fb"),ae=o("8aa3");function ie(e,t){return JSON.stringify(e)===JSON.stringify(t)}var de=o("ca72"),se=o("8edc");function ue(e){let t=e.getFullYear(),o=e.getMonth(),c=e.getDate();return o=++o>=10?o:"0"+o,`${t}-${o}-${c}`}var be={name:"ProductAdd",setup(){const e=Object(ce["e"])(),t=(Object(re["c"])(),"product"),o=new Date,r=ue(o),n={title:"",img:"",oldPrice:"",price:"",colors:[],desc:"",sale:"",forOrder:"",catalogSection:"",pubDate:r},l={title:{required:le["c"]},img:{required:le["c"]},oldPrice:{required:le["c"]},price:{required:le["c"]},colors:{required:le["c"]},desc:{required:le["c"]},catalogSection:{required:le["c"]}},a=Object(c["reactive"])({...n}),i=Object(c["ref"])(!1),d=Object(c["ref"])(!0),s=Object(c["ref"])(!1),u=Object(c["ref"])(!1),b="7iaejq0tnr1x4prtla31ao35f0mcyy7avktxha787dhulfac",m=Object(ne["a"])(l,a),p=Object(c["computed"])(()=>Object(ae["a"])(a.title)),O=Object(c["ref"])(""),j=Object(c["ref"])(""),f=Object(c["computed"])(()=>!!u.value&&ie(a,n)),v=e.getters["catalog/catalogSections"];Object(c["watch"])(p,async t=>{i.value=!!t&&await e.dispatch("product/isUniqueProduct",t)});const V=()=>{Object.keys(a).map(e=>a[e]=n[e]),m.value.$reset()},N=async()=>{if(m.value.$touch(),m.value.$error||!i.value)return;s.value=!0;const t=await e.dispatch("product/createProduct",{...a,pubDate:new Date(a.pubDate),hru:p.value});t.result?(u.value=!0,j.value=p.value,O.value=a.catalogSection,V(),await e.dispatch("alerts/alertAdd",{id:Date.now(),text:`Новый продукт успешно создан<br>\n            Перейти <a href="/catalog/${O.value}/${j.value}">просмотру.<br>\n            Перейти к <a href="/${O.value}/">каталогу</a>.\n          `,type:"success",closable:!0,autoClosable:!1}),await e.dispatch("catalog/fetchCatalogSections")):await e.dispatch("alerts/alertAdd",{id:Date.now(),text:"Ошибка сервера при создании нового продукта",type:"error",closable:!0,autoClosable:!1}),s.value=!1};return{hru:p,product:a,formName:t,isHruValid:i,isFormLoading:s,isPageLoading:d,isAlreadyCreated:u,needShowButtons:f,catalogSections:v,tinymceKey:b,reserveHru:j,reserveSection:O,onSubmit:N,v$:m}},components:{NewsInputRow:se["a"],Editor:de["a"]}},me=o("6b0d"),pe=o.n(me);const Oe=pe()(be,[["render",oe]]);t["default"]=Oe}}]);
//# sourceMappingURL=chunk-2c5cd68c.575956a0.js.map