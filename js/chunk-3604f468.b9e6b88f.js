(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3604f468"],{"29e5":function(e,t,n){"use strict";var o=n("7a23");const c={class:"loading"};function l(e,t,n,l,r,a){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",c)}var r={name:"AppLoading"},a=n("6b0d"),i=n.n(a);const d=i()(r,[["render",l]]);t["a"]=d},c2fa:function(e,t,n){"use strict";n.r(t);var o=n("7a23");const c={key:0},l={class:"form__table"},r={key:0},a=Object(o["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(o["createElementVNode"])("label",{class:"nowrap",for:"news-type"},[Object(o["createTextVNode"])("Это акция или "),Object(o["createElementVNode"])("br"),Object(o["createTextVNode"])("спецпредложение *")])],-1),i={class:"form__table-cell form__table-cell--wide"},d={class:"select"},s=Object(o["createElementVNode"])("option",{value:"action"},"Акция",-1),u=Object(o["createElementVNode"])("option",{value:"special"},"Спецпредложение",-1),b=[s,u],m={key:1},p=Object(o["createElementVNode"])("td",{class:"form__table-cell"},null,-1),f=Object(o["createElementVNode"])("td",{class:"form__table-cell form__table-cell--wide form__table-cell--pb10px"},[Object(o["createElementVNode"])("small",{class:"control-description",id:"news-type-disc"},"Поле обязательно к заполнению")],-1),O=[p,f],j=Object(o["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(o["createElementVNode"])("label",{class:"nowrap",for:"news-preview"},"Превью новости *")],-1),v={class:"form__table-cell form__table-cell--wide"},y={key:0,class:"control-error"},V=Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",{class:"form__table-cell"}),Object(o["createElementVNode"])("td",{class:"form__table-cell form__table-cell--wide form__table-cell--pb10px"},[Object(o["createElementVNode"])("small",{class:"control-description",id:"news-preview-disc"},"Поле обязательно к заполнению")])],-1),w=Object(o["createElementVNode"])("td",{class:"form__table-cell form__table-cell--pr15px"},[Object(o["createElementVNode"])("label",{class:"nowrap",for:"news-text"},"Текст новости *")],-1),g={class:"form__table-cell form__table-cell--wide"},N={key:0,class:"control-error"},E=Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",{class:"form__table-cell"}),Object(o["createElementVNode"])("td",{class:"form__table-cell form__table-cell--wide form__table-cell--pb10px"},[Object(o["createElementVNode"])("small",{class:"control-description",id:"news-text-disc"},"Поле обязательно к заполнению")])],-1),_=Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",{class:"form__table-cell"},[Object(o["createElementVNode"])("label",{class:"nowrap",for:"news-title"})]),Object(o["createElementVNode"])("td",{class:"form__table-cell form__table-cell--wide"})],-1),k=Object(o["createElementVNode"])("td",{class:"form__table-cell"},null,-1),h={class:"form__table-cell form__table-cell--wide"},C={class:"row"},B={class:"col-auto"},x=["disabled"],S={class:"col-auto"},D={class:"col-auto"};function A(e,t,n,s,u,p){const f=Object(o["resolveComponent"])("app-loading"),A=Object(o["resolveComponent"])("news-input-row"),L=Object(o["resolveComponent"])("editor"),$=Object(o["resolveComponent"])("router-link");return s.pageLoading?(Object(o["openBlock"])(),Object(o["createBlock"])(f,{key:0})):(Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],{key:1},[s.article?(Object(o["openBlock"])(),Object(o["createElementBlock"])("form",{key:1,action:"#",id:"news-edit",class:"form",onSubmit:t[5]||(t[5]=Object(o["withModifiers"])((...e)=>s.onSubmit&&s.onSubmit(...e),["prevent"]))},[Object(o["createElementVNode"])("table",l,[Object(o["createElementVNode"])("tbody",null,[s.article.type?(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",r,[a,Object(o["createElementVNode"])("td",i,[Object(o["createElementVNode"])("div",d,[Object(o["withDirectives"])(Object(o["createElementVNode"])("select",{name:"news-type",id:"news-type",class:"select__select","onUpdate:modelValue":t[0]||(t[0]=e=>s.article.type=e),"aria-describedby":"news-type-disc"},b,512),[[o["vModelSelect"],s.article.type]])])])])):Object(o["createCommentVNode"])("",!0),s.article.type?(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",m,O)):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(A,{label:"Ссылка на картинку","input-name":"news-img","form-name":"news-edit",description:"Поле НЕобязательно к заполнению. Картинка в формате jpg, png, svg, webp.\r\n                  Размер картинки не более 800*800px.\r\n                  <br> Вес картинки не более 2Мб",errors:[],controlValue:s.article.img,"onUpdate:controlValue":t[1]||(t[1]=e=>s.article.img=e)},null,8,["controlValue"]),Object(o["createVNode"])(A,{label:"Заголовок новости *","input-name":"news-title","form-name":"news-edit",description:"Поле обязательно к заполнению",errors:s.v$.title.$errors,controlValue:s.article.title,"onUpdate:controlValue":t[2]||(t[2]=e=>s.article.title=e)},null,8,["errors","controlValue"]),Object(o["createElementVNode"])("tr",null,[j,Object(o["createElementVNode"])("td",v,[Object(o["createVNode"])(L,{modelValue:s.article.preview,"onUpdate:modelValue":t[3]||(t[3]=e=>s.article.preview=e),"api-key":s.tinymceKey},null,8,["modelValue","api-key"]),s.v$.preview.$errors.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",y,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(s.v$.preview.$errors,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createElementVNode"])("div",null,Object(o["toDisplayString"])(e.$message),1)]))),256))])):Object(o["createCommentVNode"])("",!0)])]),V,Object(o["createElementVNode"])("tr",null,[w,Object(o["createElementVNode"])("td",g,[Object(o["createVNode"])(L,{modelValue:s.article.text,"onUpdate:modelValue":t[4]||(t[4]=e=>s.article.text=e),"api-key":s.tinymceKey},null,8,["modelValue","api-key"]),s.v$.text.$errors.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",N,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(s.v$.text.$errors,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createElementVNode"])("div",null,Object(o["toDisplayString"])(e.$message),1)]))),256))])):Object(o["createCommentVNode"])("",!0)])]),E,_,Object(o["createElementVNode"])("tr",null,[k,Object(o["createElementVNode"])("td",h,[Object(o["createElementVNode"])("div",C,[Object(o["createElementVNode"])("div",B,[Object(o["createElementVNode"])("button",{type:"submit",disabled:s.isLoading,class:Object(o["normalizeClass"])(["button",{"is-loading":s.isLoading}])},"Отправить",10,x)]),Object(o["createElementVNode"])("div",S,[Object(o["createVNode"])($,{to:"/"+s.tableName+"/"+s.id,class:"button"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("Смотреть")]),_:1},8,["to"])]),Object(o["createElementVNode"])("div",D,[Object(o["createVNode"])($,{to:"/"+s.tableName+"/",class:"button"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("Список всех статей")]),_:1},8,["to"])])])])])])])],32)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",c,"Новости с id = "+Object(o["toDisplayString"])(s.article.id)+" не существует",1))],64))}var L=n("5502"),$=n("6605"),M=n("c3b3"),U=n("b9fb"),I=n("ca72"),P=n("8edc"),F=n("29e5"),K={name:"ArticleEdit",setup(){const e=Object($["c"])(),t=Object(L["e"])(),n=e.params.id,c=e.meta.tableName,l=Object(o["ref"])(!1),r=Object(o["ref"])(!0),a="7iaejq0tnr1x4prtla31ao35f0mcyy7avktxha787dhulfac",i={id:e.params.id,img:"",title:"",preview:"",text:"",date:null,tableName:c},d={title:{required:U["c"]},preview:{required:U["c"]},text:{required:U["c"]},tableName:{required:U["c"]}};"specials_and_actions"===c&&(i.type="",d.type={required:U["c"]});const s=Object(o["reactive"])({...i}),u=Object(M["a"])(d,s);Object(o["onMounted"])(async()=>{const e={id:n,tableName:c},o=await t.dispatch("news/fetchOneNewsById",e),{data:l}=o;o.result?Object.keys(s).map(e=>{var t;return s[e]=null!==(t=l[e])&&void 0!==t?t:s[e]}):t.dispatch("alerts/alertAdd",{id:Date.now(),text:"Ошибка ответа от сервера при получении новости с id="+o.data.id,type:"error",closable:!0,autoClosable:!1}),r.value=!1});const b=()=>u.value.$reset(),m=async()=>{if(u.value.$touch(),u.value.$error)return;l.value=!0;const e=await t.dispatch("news/editOneNewsById",s);e.result?(b(),t.dispatch("alerts/alertAdd",{id:Date.now(),text:`Статья успешно отредактирована. <br> Перейти к <a href="/${c}/${e.data.id}" class="js-click-push">просмотру</a>`,type:"success",closable:!0,autoClosable:!1})):t.dispatch("alerts/alertAdd",{id:Date.now(),text:"Ошибка ответа от сервера при редактировании новости",type:"error",closable:!0,autoClosable:!1}),l.value=!1};return{id:n,article:s,pageLoading:r,tableName:c,isLoading:l,tinymceKey:a,v$:u,onSubmit:m}},components:{Editor:I["a"],NewsInputRow:P["a"],AppLoading:F["a"]}},R=n("6b0d"),q=n.n(R);const T=q()(K,[["render",A]]);t["default"]=T},c4a9:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var o=function(){return"undefined"!==typeof window?window:e},c=function(){var e=o();return e&&e.tinymce?e.tinymce:null}}).call(this,n("c8ba"))},ca72:function(e,t,n){"use strict";var o=n("7a23"),c=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],l=function(e){return-1!==c.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},r=function(e,t,n){Object.keys(t).filter(l).forEach((function(o){var c=t[o];"function"===typeof c&&("onInit"===o?c(e,n):n.on(o.substring(2),(function(e){return c(e,n)})))}))},a=function(e,t,n,c){var l=e.modelEvents?e.modelEvents:null,r=Array.isArray(l)?l.join(" "):l;Object(o["watch"])(c,(function(t,o){n&&"string"===typeof t&&t!==o&&t!==n.getContent({format:e.outputFormat})&&n.setContent(t)})),n.on(r||"change input undo redo",(function(){t.emit("update:modelValue",n.getContent({format:e.outputFormat}))}))},i=function(e,t,n,o,c,l){o.setContent(l()),n.attrs["onUpdate:modelValue"]&&a(t,n,o,c),r(e,n.attrs,o)},d=0,s=function(e){var t=Date.now(),n=Math.floor(1e9*Math.random());return d++,e+"_"+n+d+String(t)},u=function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()},b=function(e){return"undefined"===typeof e||""===e?[]:Array.isArray(e)?e:e.split(" ")},m=function(e,t){return b(e).concat(b(t))},p=function(e){return null===e||void 0===e},f=function(){return{listeners:[],scriptId:s("tiny-script"),scriptLoaded:!1}},O=function(){var e=f(),t=function(e,t,n,o){var c=t.createElement("script");c.referrerPolicy="origin",c.type="application/javascript",c.id=e,c.src=n;var l=function(){c.removeEventListener("load",l),o()};c.addEventListener("load",l),t.head&&t.head.appendChild(c)},n=function(n,o,c){e.scriptLoaded?c():(e.listeners.push(c),n.getElementById(e.scriptId)||t(e.scriptId,n,o,(function(){e.listeners.forEach((function(e){return e()})),e.scriptLoaded=!0})))},o=function(){e=f()};return{load:n,reinitialize:o}},j=O(),v=n("c4a9"),y={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},V=function(){return V=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var c in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c]);return e},V.apply(this,arguments)},w=function(e,t,n,o){return e(o||"div",{id:t,ref:n})},g=function(e,t,n){return e("textarea",{id:t,visibility:"hidden",ref:n})},N=Object(o["defineComponent"])({props:y,setup:function(e,t){var n=e.init?V({},e.init):{},c=Object(o["toRefs"])(e),l=c.disabled,r=c.modelValue,a=c.tagName,d=Object(o["ref"])(null),b=null,f=e.id||s("tiny-vue"),O=e.init&&e.init.inline||e.inline,y=!!t.attrs["onUpdate:modelValue"],N=!0,E=e.initialValue?e.initialValue:"",_="",k=function(e){return y?function(){return(null===r||void 0===r?void 0:r.value)?r.value:""}:function(){return e?E:_}},h=function(){var o=k(N),c=V(V({},n),{readonly:e.disabled,selector:"#"+f,plugins:m(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:O,setup:function(c){b=c,c.on("init",(function(n){return i(n,e,t,c,r,o)})),"function"===typeof n.setup&&n.setup(c)}});u(d.value)&&(d.value.style.visibility=""),Object(v["a"])().init(c),N=!1};Object(o["watch"])(l,(function(e){var t;null!==b&&("function"===typeof(null===(t=b.mode)||void 0===t?void 0:t.set)?b.mode.set(e?"readonly":"design"):b.setMode(e?"readonly":"design"))})),Object(o["watch"])(a,(function(e){var t;y||(_=b.getContent()),null===(t=Object(v["a"])())||void 0===t||t.remove(b),Object(o["nextTick"])((function(){return h()}))})),Object(o["onMounted"])((function(){if(null!==Object(v["a"])())h();else if(d.value&&d.value.ownerDocument){var t=e.cloudChannel?e.cloudChannel:"5",n=e.apiKey?e.apiKey:"no-api-key",o=p(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+n+"/tinymce/"+t+"/tinymce.min.js":e.tinymceScriptSrc;j.load(d.value.ownerDocument,o,h)}})),Object(o["onBeforeUnmount"])((function(){null!==Object(v["a"])()&&Object(v["a"])().remove(b)})),O||(Object(o["onActivated"])((function(){N||h()})),Object(o["onDeactivated"])((function(){var e;y||(_=b.getContent()),null===(e=Object(v["a"])())||void 0===e||e.remove(b)})));var C=function(e){var t;_=b.getContent(),null===(t=Object(v["a"])())||void 0===t||t.remove(b),n=V(V({},n),e),Object(o["nextTick"])((function(){return h()}))};return t.expose({rerender:C}),function(){return O?w(o["h"],f,d,e.tagName):g(o["h"],f,d)}}});t["a"]=N}}]);
//# sourceMappingURL=chunk-3604f468.b9e6b88f.js.map