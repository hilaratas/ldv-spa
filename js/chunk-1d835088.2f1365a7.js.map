{"version":3,"sources":["webpack:///./src/views/catalog/CatalogSectionAdd.vue?e5ba","webpack:///./src/views/catalog/CatalogSectionAdd.vue?5572","webpack:///./src/views/catalog/CatalogSectionAdd.vue","webpack:///./src/filter/hru.filter.ts"],"names":["_hoisted_1","_hoisted_2","class","_hoisted_3","_createElementVNode","_hoisted_4","_hoisted_5","style","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","key","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","render","_ctx","_cache","$props","$setup","$data","$options","_component_news_input_row","_resolveComponent","_component_router_link","_openBlock","_createElementBlock","action","id","formName","onSubmit","_withModifiers","args","_createVNode","inputName","label","description","controlValue","section","img","$event","errors","v$","$errors","title","_toDisplayString","hru","isHruValid","type","disabled","isFormLoading","_normalizeClass","needShowButtons","to","default","_withCtx","_createTextVNode","_","_createCommentVNode","reserveHru","defineComponent","name","setup","store","useStore","ref","sectionDefault","sectionRules","required","reactive","useVuelidate","computed","hruFilter","isAlreadyCreated","value","watch","async","newHru","dispatch","resetForm","Object","keys","map","$reset","$touch","$error","res","result","Date","now","text","closable","autoClosable","components","NewsInputRow","__exports__","str","ru","n_str","trim","replace","i","length","push","undefined","toLowerCase","toUpperCase","join"],"mappings":"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","file":"js/chunk-1d835088.2f1365a7.js","sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode, withCtx as _withCtx, withModifiers as _withModifiers } from \"vue\"\n\nconst _hoisted_1 = [\"id\"]\nconst _hoisted_2 = { class: \"form__table\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"td\", { class: \"form__table-cell\" }, \" ЧПУ \", -1)\nconst _hoisted_4 = { class: \"form__table-cell form__table-cell--wide\" }\nconst _hoisted_5 = {\n  class: \"row\",\n  style: {\"padding-bottom\":\"10px\"}\n}\nconst _hoisted_6 = { class: \"col\" }\nconst _hoisted_7 = { class: \"\" }\nconst _hoisted_8 = { class: \"col-auto\" }\nconst _hoisted_9 = {\n  key: 0,\n  class: \"check is-seccess\"\n}\nconst _hoisted_10 = {\n  key: 1,\n  class: \"check is-error\"\n}\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"td\", { class: \"form__table-cell\" }, null, -1)\nconst _hoisted_12 = { class: \"form__table-cell form__table-cell--wide\" }\nconst _hoisted_13 = { class: \"row\" }\nconst _hoisted_14 = { class: \"col-auto\" }\nconst _hoisted_15 = [\"disabled\"]\nconst _hoisted_16 = {\n  key: 0,\n  class: \"col-auto\"\n}\nconst _hoisted_17 = {\n  key: 1,\n  class: \"col-auto\"\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_news_input_row = _resolveComponent(\"news-input-row\")!\n  const _component_router_link = _resolveComponent(\"router-link\")!\n\n  return (_openBlock(), _createElementBlock(\"form\", {\n    action: \"#\",\n    id: _ctx.formName,\n    class: \"form\",\n    onSubmit: _cache[2] || (_cache[2] = _withModifiers(\n//@ts-ignore\n(...args) => (_ctx.onSubmit && _ctx.onSubmit(...args)), [\"prevent\"]))\n  }, [\n    _createElementVNode(\"table\", _hoisted_2, [\n      _createElementVNode(\"tbody\", null, [\n        _createVNode(_component_news_input_row, {\n          formName: _ctx.formName,\n          inputName: \"catalog-img\",\n          label: \"Ссылку на картинку *\",\n          description: \"Поле обязательно к заполнению.\\r\\n          Картинка в формате jpg, png, svg, webp. Размер картинки не более 800*800px.\\r\\n          <br> Вес картинки не более 2Мб\",\n          controlValue: _ctx.section.img,\n          \"onUpdate:controlValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.section.img) = $event)),\n          errors: _ctx.v$.img.$errors\n        }, null, 8, [\"formName\", \"controlValue\", \"errors\"]),\n        _createVNode(_component_news_input_row, {\n          formName: _ctx.formName,\n          inputName: \"catalog-title\",\n          label: \"Заголовок раздела *\",\n          description: \"Поле обязательно к заполнению\",\n          controlValue: _ctx.section.title,\n          \"onUpdate:controlValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.section.title) = $event)),\n          errors: _ctx.v$.title.$errors\n        }, null, 8, [\"formName\", \"controlValue\", \"errors\"]),\n        _createElementVNode(\"tr\", null, [\n          _hoisted_3,\n          _createElementVNode(\"td\", _hoisted_4, [\n            _createElementVNode(\"div\", _hoisted_5, [\n              _createElementVNode(\"div\", _hoisted_6, [\n                _createElementVNode(\"small\", _hoisted_7, _toDisplayString(_ctx.hru), 1)\n              ]),\n              _createElementVNode(\"div\", _hoisted_8, [\n                (_ctx.isHruValid)\n                  ? (_openBlock(), _createElementBlock(\"span\", _hoisted_9, \"✔\"))\n                  : (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"✘\"))\n              ])\n            ])\n          ])\n        ]),\n        _createElementVNode(\"tr\", null, [\n          _hoisted_11,\n          _createElementVNode(\"td\", _hoisted_12, [\n            _createElementVNode(\"div\", _hoisted_13, [\n              _createElementVNode(\"div\", _hoisted_14, [\n                _createElementVNode(\"button\", {\n                  type: \"submit\",\n                  disabled: _ctx.isFormLoading,\n                  class: _normalizeClass(['button', {'is-loading': _ctx.isFormLoading}])\n                }, \"Отправить\", 10, _hoisted_15)\n              ]),\n              (_ctx.needShowButtons)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_16, [\n                    _createVNode(_component_router_link, {\n                      to: \"/catalog/\",\n                      class: \"button\"\n                    }, {\n                      default: _withCtx(() => [\n                        _createTextVNode(\"Посмотреть каталог\")\n                      ]),\n                      _: 1\n                    })\n                  ]))\n                : _createCommentVNode(\"\", true),\n              (_ctx.needShowButtons)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_17, [\n                    _createVNode(_component_router_link, {\n                      to: '/catalog/edit/' + _ctx.reserveHru,\n                      class: \"button\"\n                    }, {\n                      default: _withCtx(() => [\n                        _createTextVNode(\"Редактировать раздел каталога\")\n                      ]),\n                      _: 1\n                    }, 8, [\"to\"])\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ])\n          ])\n        ])\n      ])\n    ])\n  ], 40, _hoisted_1))\n}","\r\nimport NewsInputRow from \"@/components/News/NewsInputRow.vue\";\r\nimport { ref, computed, reactive, watch, defineComponent } from \"vue\"\r\nimport { useStore } from \"vuex\"\r\nimport { useVuelidate } from '@vuelidate/core'\r\nimport { required } from '@vuelidate/validators'\r\nimport { hruFilter } from \"@/filter/hru.filter\";\r\nimport { CatalogSectionCrop} from \"@/typings\";\r\n\r\nexport default defineComponent({\r\n  name: \"CatalogSectionAdd\",\r\n  setup() {\r\n    const store = useStore()\r\n    const formName = \"catalog-types\"\r\n    const isFormLoading = ref(false)\r\n    const sectionDefault = { img: \"\", title: \"\" }\r\n    const sectionRules = {\r\n          img: {required},\r\n          title: {required}\r\n        }\r\n    const section = reactive({...sectionDefault})\r\n    const v$ = useVuelidate(sectionRules, section)\r\n    const hru = computed(() => hruFilter(section.title))\r\n    let reserveHru = ref('')\r\n    const isAlreadyCreated = ref(false)\r\n    const needShowButtons = computed(() => (\r\n        !isAlreadyCreated.value ?  false :  !(section.img || section.title )\r\n      ))\r\n    const isHruValid = ref(false)\r\n\r\n    watch( hru, async (newHru) => {\r\n      if ( !newHru ) {\r\n        isHruValid.value = false\r\n        return\r\n      }\r\n      isHruValid.value = await store.dispatch('catalog/isUniqueCatalogSection', newHru)\r\n    })\r\n\r\n    const resetForm = () => {\r\n      Object.keys(section).map(key => section[key as keyof CatalogSectionCrop] = sectionDefault[key as keyof CatalogSectionCrop])\r\n      v$.value.$reset()\r\n    }\r\n\r\n    const onSubmit = async () => {\r\n      v$.value.$touch()\r\n      if (v$.value.$error || !isHruValid.value) {\r\n        return;\r\n      }\r\n\r\n      isFormLoading.value = true\r\n      const res = await store.dispatch('catalog/createCatalogSection', {...section, hru: hru.value})\r\n      if (res.result) {\r\n        isAlreadyCreated.value = true\r\n        reserveHru.value = hru.value\r\n        resetForm()\r\n        await store.dispatch('alerts/alertAdd', {\r\n          id: Date.now(),\r\n          text: `Новый раздел каталога успешно создан`,\r\n          type: 'success',\r\n          closable: true,\r\n          autoClosable: false\r\n        })\r\n        await store.dispatch('catalog/fetchCatalogSections')\r\n      } else {\r\n        await store.dispatch('alerts/alertAdd', {\r\n          id: Date.now(),\r\n          text: 'Ошибка сервера при создании нового раздела каталога',\r\n          type: 'error',\r\n          closable: true,\r\n          autoClosable: false\r\n        })\r\n      }\r\n      isFormLoading.value = false\r\n    }\r\n    return {\r\n      isFormLoading,\r\n      formName,\r\n      section,\r\n      hru,\r\n      v$,\r\n      isAlreadyCreated,\r\n      needShowButtons,\r\n      onSubmit,\r\n      isHruValid,\r\n      reserveHru\r\n    }\r\n  },\r\n  components: { NewsInputRow }\r\n})\r\n","import { render } from \"./CatalogSectionAdd.vue?vue&type=template&id=2dd1069b&ts=true\"\nimport script from \"./CatalogSectionAdd.vue?vue&type=script&lang=ts\"\nexport * from \"./CatalogSectionAdd.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"C:\\\\Programming\\\\LDV spa\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","interface TranslitSymbol {\r\n  [key: string] : string\r\n}\r\n\r\nexport function hruFilter (str :string ) :string {\r\n  var ru : TranslitSymbol = {\r\n    'а': 'a', 'б': 'b', 'в': 'v', 'г': 'g', 'д': 'd',\r\n    'е': 'e', 'ё': 'e', 'ж': 'j', 'з': 'z', 'и': 'i',\r\n    'к': 'k', 'л': 'l', 'м': 'm', 'н': 'n', 'о': 'o',\r\n    'п': 'p', 'р': 'r', 'с': 's', 'т': 't', 'у': 'u',\r\n    'ф': 'f', 'х': 'h', 'ц': 'c', 'ч': 'ch', 'ш': 'sh',\r\n    'щ': 'shch', 'ы': 'y', 'э': 'e', 'ю': 'u', 'я': 'ya',\r\n    ' ': '-'\r\n  }, n_str = [];\r\n\r\n  str = str.trim().replace(/[ъь]+/g, '').replace(/й/g, 'i');\r\n\r\n  for (var i = 0; i < str.length; ++i) {\r\n    n_str.push(\r\n      ru[str[i]]\r\n      || ru[str[i].toLowerCase()] == undefined && str[i]\r\n      || ru[str[i].toLowerCase()].toUpperCase()\r\n    );\r\n  }\r\n\r\n  return n_str.join('');\r\n}\r\n\r\n"],"sourceRoot":""}